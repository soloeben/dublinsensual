<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dublin Sensual Festival — Oct 29–Nov 1, 2026 | Dublin, Ireland</title>
  <meta name="description" content="Dublin Sensual Festival — Ireland's largest Latin dance extravaganza. Four days of Salsa & Bachata workshops, socials, shows, and international DJs. Oct 29–Nov 1, 2026 in Dublin, Ireland." />
  <!-- UPDATED LOGO PATH (4) -->
  <link rel="icon" type="image/png" href="assets/home/logo.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800;900&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#07070a;           /* Main dark background */
      --panel:#0d0d13;        /* Secondary dark background (used for contrast) */
      --panel-2:#101018;      /* Third dark background */
      --text:#f3f5fa;         /* Light text */
      --muted:#b6bbca;        /* Muted text */
      --brand:#8b5cf6;        /* Primary brand color (Violet) */
      --brand-2:#ffffff;      /* Secondary brand color (White) */
      --border:#1a1d2a;       /* Border/separator color */

      --violet-bg:#0b0a13; --violet-ink:rgba(139,92,246,.15);
      --container:1300px;
      --radius:18px;
      --shadow:0 12px 30px rgba(0,0,0,.25);
    }

    /* Base (REQ 6: Mobile fit is ensured by viewport meta and relative units) */
    *{box-sizing:border-box}
    html,body{margin:0; padding:0; height:100%;}
    body{
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      color:var(--text); background:var(--bg); -webkit-text-size-adjust:100%;
    }
    img, video{max-width:100%; height:auto; display:block}
    a{color:var(--brand); text-decoration:none}
    a:hover{text-decoration:underline}

    /* Layout */
    .container{max-width:var(--container); margin-inline:auto; padding:clamp(14px,2vw,24px)}
    .grid{display:grid; gap:clamp(14px,1.8vw,22px)}

    /* Header / Nav (REQ 2: Increased logo size) */
    .site-header{
      position:sticky; top:0; z-index:100;
      background:var(--bg);
      border-bottom:1px solid var(--border);
      padding-block:12px 14px;
      box-shadow:0 4px 10px rgba(0,0,0,.25);
    }
    .nav{display:flex; justify-content:space-between; align-items:center}
    /* REQ 2: Removed text from brand, kept overall size consistent by only increasing logo size */
    .brand{display:flex; align-items:center; gap:8px; font-weight:800; font-size:clamp(16px,2vw,20px); letter-spacing:0.04em;}
    .brand img{height:40px; width:40px; object-fit:contain} /* Increased from 30px */
    .nav-link{padding:8px 14px; color:var(--text); font-weight:600; text-transform:uppercase; letter-spacing:0.03em}
    .nav-link:hover{color:var(--brand)}
    .nav-cta{
      background:var(--brand); color:#fff; border-radius:999px; padding:10px 18px; font-weight:800;
      box-shadow:0 8px 20px color-mix(in srgb, var(--brand) 40%, transparent);
      transition:transform 0.2s ease, box-shadow 0.2s ease;
      text-transform:uppercase; letter-spacing:0.04em;
    }
    .nav-cta:hover{transform:translateY(-1px); box-shadow:0 10px 25px color-mix(in srgb, var(--brand) 60%, transparent); text-decoration:none}

    /* CTA BUTTON FIX (3) - Ensures text is centered and button takes full width of tile on mobile */
    .tile .nav-cta {
        display: block;
        text-align: center;
        width: 100%;
    }

    /* HERO Section (REQ 1: Full screen height) */
    .hero{
      height:100svh; /* Use svh for reliable full screen height on mobile and desktop */
      position:relative; isolation:isolate; overflow:hidden;
    }
    
    .hero__media{
      position:absolute; inset:0; width:100%; height:100%;
      display:flex; align-items:center; justify-content:center; /* Used for 16:9 centering */
      overflow:hidden;
    }

    /* REQ 1: Desktop 16:9 ratio and centering for image */
    .hero__media img{ /* Changed from video to image */
        width:100%; height:100%; object-fit:cover; object-position: center;
        /* Default for mobile and screens taller than 16:9 */
    }

    @media (min-aspect-ratio: 16/9) {
        .hero__media img { /* Changed from video to image */
            /* If screen is wider than 16:9, calculate width based on height to maintain 16:9 */
            width: calc(100svh * 16 / 9);
            height: 100svh;
            min-width: 100%; /* Ensure full horizontal coverage if the ratio isn't perfect */
        }
    }

    /* REQ 4: Reduced tint effect */
    .hero__media::after{
      content:''; position:absolute; inset:0;
      background:rgba(0,0,0,.40); /* Reduced tint opacity to .40 */
      z-index:1;
    }

    .hero__content{
      position:absolute; inset:0; z-index:2;
      display:flex; flex-direction:column; align-items:center; justify-content:center;
      text-align:center;
      padding:clamp(20px, 4vw, 40px);
    }
    .headline{
      font-size:clamp(36px, 10vw, 120px); font-weight:900; line-height:.95; margin:.2rem 0 .5rem;
      text-transform:uppercase; letter-spacing:.02em;
      text-shadow:0 4px 12px rgba(0,0,0,.8);
    }
    .subline{
      font-size:clamp(16px, 3vw, 24px); font-weight:600; color:var(--brand-2);
      text-shadow:0 2px 8px rgba(0,0,0,.6);
      padding:.5rem 1rem; border-radius:8px;
    }

    /* Sections */
    .section{
      padding:clamp(60px, 8vw, 120px) 0;
      background:var(--bg); /* Default background */
    }
    /* REQ 3: Background contrast for split sections */
    .section--split{
      background:var(--panel); /* Use secondary panel color for contrast */
    }
    .header{text-align:center; max-width:900px; margin:0 auto 40px;}
    .title{font-size:clamp(28px, 4vw, 48px); font-weight:900; text-transform:uppercase; margin:0 0 .5rem;}
    .subtitle{color:var(--muted); font-size:clamp(16px, 2vw, 20px); max-width:70ch; margin:0 auto;}

    /* Image Strip */
    .image-strip{
        padding: 0;
        background: var(--bg);
        overflow: hidden;
    }
    .image-strip img{
        width: 100%;
        height: calc(100vw * 9 / 16);
        max-height: 400px; /* Cap for massive screens */
        object-fit: cover;
        object-position: center;
        display: block;
    }

    /* Bento Grid (Updated for image tiles REQ 4, 5, 6) */
    .bento{grid-template-columns:repeat(12, minmax(0, 1fr))}

    .tile{
      background:var(--panel-2);
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:clamp(16px,1.8vw,24px);
      box-shadow:var(--shadow);
      display: flex; /* Ensure inner content is manageable */
      flex-direction: column;
    }
    .tile h3{margin:.2rem 0 .5rem; font-size:clamp(18px,1.6vw,22px); color:var(--brand-2)}
    .tile p{color:var(--muted)}

    /* Image Tile Specific Style */
    .tile--image {
        padding: 0; /* Remove padding from tile itself */
        overflow: hidden;
        transition: transform 0.2s ease;
    }
    .tile--image:hover {
        transform: translateY(-2px);
        box-shadow: 0 16px 35px rgba(0,0,0,.35);
    }
    .tile--image__media {
        width: 100%;
        height: 180px; /* Fixed height for image consistency */
        overflow: hidden;
    }
    .tile--image__media img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        /* UPDATED OBJECT POSITION (2) - Show image from the top */
        object-position: top;
        transition: transform 0.4s ease;
    }
    .tile--image:hover .tile--image__media img {
        transform: scale(1.05);
    }
    .tile--image__content {
        padding: clamp(16px,1.8vw,24px);
    }


    /* Animation for Artists Marquee (REQ 10) */
    @keyframes marquee {
        from { transform: translateX(0); }
        to { transform: translateX(calc(-50% + 11px)); }
    }

    .marquee-container {
        overflow: hidden;
        /* Mask to fade content at the edges */
        mask-image: linear-gradient(to right, transparent 0%, var(--bg) 10%, var(--bg) 90%, transparent 100%);
        margin-bottom: 20px;
    }

    .artist-marquee {
        display: flex;
        animation: marquee 30s linear infinite; /* Adjust duration for speed */
        width: fit-content; /* Critical: allow content to define width */
        padding-right: 22px; /* Padding to ensure smooth loop break */
    }

    .artist-marquee .tile {
        flex-shrink: 0;
        width: 280px; /* Fixed width for scrolling consistency */
        margin-right: 22px; /* Gap between tiles */
        box-shadow: var(--shadow);
    }

    /* Footer */
    footer{padding:40px 0; border-top:1px solid var(--border); background:var(--panel)}
    .footer-grid{grid-template-columns:repeat(4, 1fr)}
    .footer-col{color:var(--muted)}
    .footer-col a{color:var(--muted)}
    .footer-col h4{color:var(--text); margin-top:0; font-size:18px}
    .footer-col ul{list-style:none; padding:0}
    .footer-col li{margin-bottom:8px}

    /* Mobile overrides */
    @media (max-width: 900px){ .nav-links{display:none} .footer-grid{grid-template-columns:1fr 1fr} .footer-col:nth-child(3){grid-column:1/2} .footer-col:nth-child(4){grid-column:2/3} }
    @media (max-width: 600px){ .footer-grid{grid-template-columns:1fr} }
  </style>

  <style>
    /* Floating Search Button */
    .search-fab{position:fixed;right:18px;bottom:18px;z-index:60;width:56px;height:56px;border-radius:50%;border:1px solid var(--border);background:var(--panel);display:flex;align-items:center;justify-content:center;box-shadow:0 10px 24px rgba(0,0,0,.45);cursor:pointer}
    .search-fab img{width:26px;height:26px}
    .search-fab:hover{transform:translateY(-1px)}

    /* Search Modal */
    .modal{position:fixed;inset:0;z-index:70;display:none}
    .modal.open{display:block}
    .modal-backdrop{position:absolute;inset:0;background:rgba(3,3,6,.6);backdrop-filter:blur(4px)}
    .modal-dialog{position:relative;max-width:900px;margin:10vh auto;background:var(--panel);border:1px solid var(--border);border-radius:16px;padding:16px}
    .modal-header{display:flex;align-items:center;gap:10px}
    .modal-header input[type="search"]{flex:1;background:#0f1118;border:1px solid var(--border);color:var(--text);padding:12px 14px;border-radius:12px;font-size:16px}
    .modal-close{background:#0f1118;border:1px solid var(--border);color:var(--muted);padding:10px 12px;border-radius:10px;cursor:pointer}
    .results{margin-top:14px;max-height:60vh;overflow:auto;display:grid;gap:10px}
    .result{border:1px solid var(--border);border-radius:12px;padding:12px;background:var(--panel-2)}
    .result a{font-weight:700}
    .result small{color:var(--muted)}
  </style>
</head>
<body>

  <!-- Header -->
  <header class="site-header">
    <div class="container nav">
      <!-- UPDATED LOGO PATH (4) -->
      <div class="brand">
        <img src="assets/home/logo.png" alt="DSF Logo" />
      </div>
      <nav class="nav-links">
        <!-- REQ 3: Updated links and filepaths -->
        <a class="nav-link" href="index.html">Home</a>
        <a class="nav-link" href="venue.html">Venue</a>
        <a class="nav-link" href="lineup.html">Line Up</a>
        <a class="nav-link" href="faq.html">FAQ</a>
      </nav>
      <a class="nav-cta" href="https://www.eventbrite.com/e/dublin-sensual-festival-sbk-2026-3rd-edition-tickets-1806334287479?aff=ebdssbdestsearch&keep_tld=1" target="_blank">Get Your Pass</a>
    </div>
  </header>

  <!-- HERO -->
  <section class="hero" id="home">
    <div class="hero__media">
      <!-- HERO IMAGE PATH FIXED (1) -->
      <img src="images/home/hero.jpg" alt="Dublin Sensual Festival Dancers and Party" loading="eager" />
    </div>
    <div class="hero__content container">
      <div class="reveal">
        <div class="subline">October 29 - November 1, 2026 | Dublin, Ireland</div>
        <h1 class="headline">4 Days of Pure Sensual<br/>Rhythm</h1>
        <a class="nav-cta" href="https://www.eventbrite.com/e/dublin-sensual-festival-sbk-2026-3rd-edition-tickets-1806334287479?aff=ebdssbdestsearch&keep_tld=1" target="_blank" style="margin-top:20px; font-size:clamp(16px, 2vw, 20px);">Tickets & Info</a>
      </div>
    </div>
  </section>


  <!-- ABOUT -->
<section id="about" class="section violet">
  <div class="container grid grid-2">
    <div class="panel">
      <h2>About Dublin Sensual</h2>
      <p>Dublin Sensual Festival brings dancers together for four unforgettable days of workshops, socials, and shows in Bachata and Salsa — powered by international artists and DJs.</p>
      <p>From absolute beginners to seasoned pros, dive into the music, refine your technique, and meet an amazing community in the heart of Dublin.</p>
      <div class="ph-img" aria-hidden="true" style="margin-top:12px;background-image:url('/images/home/about.jpg');"></div>
    </div>
    <div class="panel" id="event-details">
      <h2>Event Details</h2>
      <ul class="list" style="margin:0 0 12px;padding-left:18px">
        <li><strong>Dates:</strong> Thu–Sun, 29.10.2026 – 01.11.2026</li>
        <li><strong>City:</strong> Dublin, Ireland</li>
        <li><strong>Venue:</strong> St Vincent’s GAA Club — Malahide Rd, Marino, Dublin 3. <em>Thursday only</em> at Madigan’s, O’Connell Street, Dublin 1.</li>
        <li><strong>Passes:</strong> Full Pass & style-specific options</li>
        <li><strong>Tickets:</strong> Get your tickets from Eventbrite</li>
      </ul>
      <div class="ph-img" aria-hidden="true" style="margin-top:12px;background-image:url('/images/home/event.jpg');"></div>
    </div>
  </div>
</section>

  <!-- Tickets & Passes Section (section--split for contrast - REQ 3) -->
  <section class="section section--split" id="tickets">
    <div class="container">
      <div class="header reveal">
        <h2 class="title">Passes & Registration</h2>
        <p class="subtitle">Secure your spot now! All passes include access to workshops and all social parties.</p>
      </div>
      <div class="grid bento">
        <div class="tile span-4 reveal" style="grid-column:span 4">
          <h3>Full Pass</h3>
          <p>Access to all workshops, shows, and social parties for the entire festival weekend.</p>
          <!-- CTA BUTTON FIX (3) - Style is applied via the CSS class rule above -->
          <a class="nav-cta" href="https://ti.to/dublinsensual" target="_blank" style="margin-top:15px; background:var(--brand-2); color:var(--bg)">Buy Now</a>
        </div>
        <div class="tile span-4 reveal" style="grid-column:span 4; animation-delay:0.1s;">
          <h3>Day Pass</h3>
          <p>Perfect for locals! Choose a specific day to attend the workshops and evening social.</p>
          <!-- CTA BUTTON FIX (3) - Style is applied via the CSS class rule above -->
          <a class="nav-cta" href="https://ti.to/dublinsensual" target="_blank" style="margin-top:15px; background:var(--brand-2); color:var(--bg)">See Options</a>
        </div>
        <div class="tile span-4 reveal" style="grid-column:span 4; animation-delay:0.2s;">
          <h3>Party Pass</h3>
          <p>For night owls—includes access to all evening social parties and shows only.</p>
          <!-- CTA BUTTON FIX (3) - Style is applied via the CSS class rule above -->
          <a class="nav-cta" href="https://ti.to/dublinsensual" target="_blank" style="margin-top:15px; background:var(--brand-2); color:var(--bg)">Get Party Pass</a>
        </div>
      </div>
    </div>
  </section>

  <!-- REQ 7: New Image Strip Section 1 below passes - image path fixed -->
  <section class="image-strip">
    <img src="images/home/strip1.jpg" alt="Dublin Sensual Festival party atmosphere" loading="lazy">
  </section>

  <!-- Jack & Jill Section (back to default background) -->
  <section class="section" id="jack-jill">
    <div class="container">
      <div class="header reveal">
        <h2 class="title">Jack & Jill Competition</h2>
        <p class="subtitle">Test your social dancing skills in a fun, spontaneous competition setting! Open to all levels.</p>
      </div>
      <div class="grid bento">
        <div class="tile span-6 reveal" style="grid-column:span 6">
          <h3>Novice Division</h3>
          <p>Designed for newer dancers. Focus on foundational technique and leading/following connection.</p>
        </div>
        <div class="tile span-6 reveal" style="grid-column:span 6; animation-delay:0.1s;">
          <h3>Advanced Division</h3>
          <p>For experienced dancers. Showcase musicality, creativity, and advanced partnership skills.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- REQ 8: Existing Image Strip Section 2 below J&J - image path fixed -->
  <section class="image-strip">
    <img src="images/home/strip2.jpg" alt="Highlight reel of the Dublin Sensual Festival dancers and community." loading="lazy">
  </section>

  <!-- Venue Section (section--split for contrast - REQ 3) -->
  <section class="section section--split" id="venue">
    <div class="container">
      <div class="header reveal">
        <h2 class="title">The Venue</h2>
        <p class="subtitle">All workshops and parties will take place at the luxurious and spacious **St Vincent's GAA Club** in Dublin.</p>
      </div>
      <div class="grid bento">
        <div class="tile span-12 reveal" style="overflow:hidden; position: relative; padding-bottom: 56.25%;">
          <!-- REQ 9: Google Map Embed Fix (Simplified Query) -->
          <iframe
            src="https://maps.google.com/maps?q=St%20Vincent's%20GAA%20Club%2C%20Dublin%203&t=&z=14&ie=UTF8&iwloc=&output=embed"
            width="100%"
            height="100%"
            style="border:0; border-radius:var(--radius); position: absolute; top: 0; left: 0; bottom: 0; right: 0;"
            allowfullscreen=""
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade">
          </iframe>
        </div>
      </div>
    </div>
  </section>

  <!-- Artists Section (REQ 10: Marquee Animation) -->
  <section class="section" id="artists">
    <div class="container">
      <div class="header reveal">
        <h2 class="title">Featured Artists</h2>
        <p class="subtitle">Meet the international lineup of instructors and DJs leading our workshops and socials this year.</p>
      </div>

      <!-- REQ 10: Marquee / Scrolling Tiles -->
      <div class="marquee-container reveal">
        <div class="artist-marquee">
          <!-- Initial Set of Tiles (Cloned below to create a seamless loop) -->
          <div class="tile artist-tile"><h3>Artist A</h3><p>Specialty: Bachata</p></div>
          <div class="tile artist-tile"><h3>Artist B</h3><p>Specialty: Salsa</p></div>
          <div class="tile artist-tile"><h3>Artist C</h3><p>Specialty: Kizomba</p></div>
          <div class="tile artist-tile"><h3>Artist D</h3><p>Specialty: DJ & Music</p></div>

          <!-- Clones for seamless loop -->
          <div class="tile artist-tile"><h3>Artist A</h3><p>Specialty: Bachata</p></div>
          <div class="tile artist-tile"><h3>Artist B</h3><p>Specialty: Salsa</p></div>
          <div class="tile artist-tile"><h3>Artist C</h3><p>Specialty: Kizomba</p></div>
          <div class="tile artist-tile"><h3>Artist D</h3><p>Specialty: DJ & Music</p></div>
        </div>
      </div>

      <!-- REQ 10: Button to Line Up Page -->
      <div class="text-center reveal" style="text-align:center;">
        <a class="nav-cta" href="lineup.html" style="margin-top:20px;">View Full Line Up</a>
      </div>
    </div>
  </section>

  <!-- Footer (REQ 11: Quick links and Email) -->
  <footer>
    <div class="container grid footer-grid">
      <div class="footer-col reveal">
        <h4>Dublin Sensual Festival</h4>
        <p>Ireland's largest Latin dance festival. Bringing passion, rhythm, and community together.</p>
      </div>
      <div class="footer-col reveal" style="animation-delay:0.1s;">
        <h4>Quick Links</h4>
        <ul>
          <!-- REQ 11: Updated Quick Links -->
          <li><a href="index.html">Home</a></li>
          <li><a href="venue.html">Venue</a></li>
          <li><a href="lineup.html">Line Up</a></li>
          <li><a href="faq.html">FAQ</a></li>
        </ul>
      </div>
      <div class="footer-col reveal" style="animation-delay:0.2s;">
        <h4>Contact</h4>
        <ul>
          <!-- REQ 11: Updated Email -->
          <li>Email: <a href="mailto:quedadassalseras@gmail.com">quedadassalseras@gmail.com</a></li>
          <li><a href="https://ti.to/dublinsensual" target="_blank">Tickets</a></li>
        </ul>
      </div>
      <div class="footer-col reveal" style="animation-delay:0.3s;">
        <h4>Legal</h4>
        <ul>
          <li><a href="#">Terms & Conditions</a></li>
          <li><a href="#">Privacy Policy</a></li>
          <li>&copy; 2026 DSF</li>
        </ul>
      </div>
    </div>
  </footer>

  <script>
    // REQ 5 (from previous turn): Reveal on scroll (One-time animation)
    const io = new IntersectionObserver((entries)=>entries.forEach(e=>{
      if(e.isIntersecting){
        e.target.classList.add('in');
        // Stop observing the element once the animation is triggered (one-time animation)
        io.unobserve(e.target);
      }
    }), {threshold:.15});

    document.querySelectorAll('.reveal').forEach(el=>io.observe(el));
  </script>

  <!-- Floating Search Button -->
<button id="searchFab" class="search-fab" aria-label="Open site search" title="Search">
  <img src="/assets/search.png" alt="Search icon">
</button>

<!-- Search Modal -->
<div id="searchModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="searchTitle">
  <div class="modal-backdrop" data-close></div>
  <div class="modal-dialog">
    <div class="modal-header">
      <input id="searchInput" type="search" placeholder="Search the site (artists, venue, schedule, tickets, …)" autocomplete="off" aria-label="Search the site">
      <button class="modal-close" data-close>Close</button>
    </div>
    <div id="searchResults" class="results" role="list"></div>
  </div>
</div>

<script>
// Floating Search Modal + Client-side Site Search with deep links to sections
(function(){
    var openBtn = document.getElementById('searchFab');
    var modal = document.getElementById('searchModal');
    var input = document.getElementById('searchInput');
    var results = document.getElementById('searchResults');

    function open(){ modal.classList.add('open'); input.focus(); }
    function close(){ modal.classList.remove('open'); input.value=''; results.innerHTML=''; }

    openBtn.addEventListener('click', open);
    modal.addEventListener('click', function(e){ if(e.target.hasAttribute('data-close')) close(); });
    document.addEventListener('keydown', function(e){ if(e.key==='Escape') close(); });

    var PAGES = [
      { url: 'index.html', title: 'Home' },
      { url: 'venue.html', title: 'Venue' },
      { url: 'lineup.html', title: 'Line Up' },
      { url: 'schedule.html', title: 'Schedules' },
      { url: 'faq.html', title: 'FAQ' }
    ];

    var index = [];
    function strip(html){
      var tmp = document.createElement('div'); tmp.innerHTML = html;
      tmp.querySelectorAll('script,style,noscript').forEach(n=>n.remove());
      return (tmp.textContent || '').replace(/\s+/g,' ').trim();
    }
    function collectAnchors(doc){
      var anchors = [];
      doc.querySelectorAll('[id], section[id], h2[id]').forEach(function(el){
        var id = el.getAttribute('id'); if(!id) return;
        var text = (el.textContent||'').trim();
        if(text.length>0) anchors.push({id:id, text:text.toLowerCase()});
      });
      return anchors;
    }

    Promise.all(PAGES.map(function(p){
      return fetch(p.url).then(r=>r.text()).then(function(t){
        var wrapper = document.implementation.createHTMLDocument('x');
        wrapper.documentElement.innerHTML = t;
        index.push({ url:p.url, title:p.title, text: strip(t).toLowerCase(), anchors: collectAnchors(wrapper) });
      }).catch(function(){ index.push({ url:p.url, title:p.title, text:'', anchors:[] }); });
    }));

    function findBestAnchor(item, query){
      var q = query.toLowerCase();
      var hit = item.anchors.find(a => a.text.indexOf(q) !== -1);
      return hit ? ('#'+hit.id) : '';
    }
    function highlightSnippet(text, query){
      var i = text.indexOf(query.toLowerCase());
      if(i === -1) return text.slice(0,160) + '…';
      var start = Math.max(0, i-60), end = Math.min(text.length, i+100);
      var snippet = text.slice(start, end);
      return (start>0?'…':'') + snippet + (end<text.length?'…':'');
    }

    var deb;
    input.addEventListener('input', function(){
      clearTimeout(deb);
      var q = input.value.trim();
      deb = setTimeout(function(){
        if(!q){ results.innerHTML=''; return; }
        var qq = q.toLowerCase();
        var hits = index.filter(function(item){ return item.text && item.text.indexOf(qq) !== -1; }).slice(0,20);
        if(hits.length===0){ results.innerHTML = '<div class="result">No results yet. Try another keyword (e.g., \"venue\", \"ticket\", \"artist\").</div>'; return; }
        results.innerHTML = hits.map(function(h){
          var frag = findBestAnchor(h, qq);
          var snippet = highlightSnippet(h.text, qq).replaceAll('<','&lt;');
          return '<div class="result" role="listitem"><a href="'+h.url+frag+'">'+h.title+(frag?(' · '+frag.replace('#','')):'')+'</a><div><small>'+snippet+'</small></div></div>';
        }).join('');
      }, 140);
    });
  })();
</script>
</body>
</html>
